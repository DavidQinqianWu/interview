# 网络

::: tip
前端而言, 网络往往伴随着浏览器一起说出, 而网络是前端不可或缺需要了解, 因为这与大厂考察的优话是息息相关的
:::

## http 1.1 / http 2.0/ webSocket / https

### http 1.1

- 长连接，HTTP 1.1 支持长连接（PersistentConnection）和请求的流水线（Pipelining）处理，在一个 TCP 连接上可以传送多个 HTTP 请求和响应，减少了建立和关闭连接的消耗和延迟，在 HTTP1.1 中默认开启 Connection： keep-alive，一定程度上弥补了 HTTP1.0 每次请求都要创建连接的缺点。但是请求还是一次一次进行的, 完成这个请求才能开始下个

### http 2.0

- 服务端推送（server push）HTTP2.0 有 server push 功能, 例如我的网页有一个 sytle.css 的请求，在客户端收到 sytle.css 数据的同时，服务端会将 sytle.css 的文件推送给客户端，当客户端再次尝试获取 sytle.css 时就可以直接从`缓存`中获取到，不用再发请求了
- 可以同时发送多个请求,如果有一个请求的时间特别长,不会影响另外的请求
- 压缩 http 协议的头文件, 减少请求体积

![http2](./img/http2.png)

### webSocket

webSocket 是针对 http1.1 做的进一步改进, 能够让双方间建立实施的双向通信,WebSocket 的最大特点就是，**服务器可以主动向客户端推送信息，客户端也可以主动向服务器发送信息**，是真正的双向平等对话

WebSocket 的其他特点：

- 建立在 TCP 协议之上，服务器端的实现比较容易。
- 与 HTTP 协议有着良好的兼容性。默认端口也是 80 和 443，并且握手阶段采用 HTTP 协议，因此握手时不容易屏蔽，能通过各种 HTTP 代理服务器。
- 数据格式比较轻量，性能开销小，通信高效。
- 可以发送文本，也可以发送二进制数据。
- 没有同源限制，客户端可以与任意服务器通信。
- 协议标识符是 ws（如果加密，则为 wss），服务器网址就是 URL。

### https

- `http + 机密+ 认证+ 完整性保护 = https`, 是 http + SSL
- 公开密钥加密: 是一种公开加密的技术, 相当于我自己有一个本地的私钥, 然后我还有一个在共享功能的公钥, 任何人要给我发信息, 都可以用这个公钥进行加密, 然后加密之后的解密只有这个私钥才能解开
- 共享秘钥加密 : 速度快, 安全性差. 相当两者之间保留自己的钥匙, 公用一个锁

:::tip
https 采用两者混合的模式, 在初次建立连接交换共享秘钥的时候应该是采用, 公开密钥加密方式, 这样当两个安全的拿到共享秘钥的口令之后, 就可以采用共享秘钥加密进行交流, 因为他们之间传播速度更快
:::

## 描述一次完整的 HTTP 请求

### 1. DNS 如何找到域名

1. DNS 域名解析采用**递归查询**.过程: 首先去找 DNS 缓存 => 缓存如果没有就找根域名服务器 => 根域名服务器又会去找下一级. 这样递归查找之后,就找到我们的 web 浏览器要访问的服务器

2. DNS 也可以采用**迭代查询**. 迭代查询就是, 我们查询根服务器, 根服务器告诉我们下一级的服务器的 ip 地址, 我们自己需要主动去下一级查询
3. 为了减少根服务器的压力, 通常会设置缓存. 例如 物理学院的电脑会先到清华大学的与域服务器访问,如果与服务器发现之前有人已经访问过 baidu 的域名, 那么与服务器就会直接给返回对应的 ip 地址, 这样域服务器就不用再去访问那个根服务器了, 减少了访问次数

### 2. 三次握手, 建立 TPC 连接

### 3. 发送 HTTP 协议 (应用层), 请求 http 页面

1. 在 http 协议中,有常见的几个文段,connection, user-agent 还有 cookie 字段等等
2. 我们会得到响应码, 常见的响应码有
   ![响应状态码](./img/responseCode.png)
3. 常见的 14 种 :

   - 200 - 成功
   - 204 - no content 表示已经成功,但是响应报文中没有 body 部分
   - 206 - 表示服务器已经对部分请求给与了响应
   - 301 - 表示你的这个请求已经被永久改变了位置. 所以在给 301 的时候, 响应报文中的 location 字段会给新的 url
   - 302 - 表示你请求的这个已经被临时改变了位置.
   - 303 - 与 302 一样, 同时告诉浏览器已经采用 GET 方法去获取这个新的 url
   - 304 - 服务器告知代你请求的东西没有更新, 客户端你可以使用缓存, 协商缓存
   - 400 - 服务器不理解请求的语法(通常是我们客户端发送的请求参数不对)
   - 401 - 当前请求需要进行身份验证
   - 500 - 服务器遇到错误, 无法完成请求

     [状态码详解:](https://blog.csdn.net/qq_37960324/article/details/83374855)

### 4. 四次挥手断开连接
